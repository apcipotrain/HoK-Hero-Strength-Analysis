import pandas as pd

# ==========================================
# 1. 2025 KPL 春季赛完整数据 (97条)
# ==========================================
spring_data = [
    ["公孙离", 173, 92],["阿古朵", 171, 88],["夏侯惇", 169, 87],["沈梦溪", 165, 84],
    ["孙尚香", 159, 83],["苍", 154, 76],["夏洛特", 151, 74],["朵莉亚", 151, 72],
    ["戈娅", 149, 74],["太乙真人", 146, 86],["元流之子（坦克）", 145, 71],["狂铁", 143, 79],
    ["少司缘", 132, 61],["大司命", 127, 63],["大乔", 126, 58],["梦奇", 124, 54],
    ["不知火舞", 122, 63],["敖隐", 115, 51],["曹操", 112, 62],["关羽", 112, 58],
    ["司空震", 112, 57],["鲁班大师", 107, 54],["马超", 106, 54],["甄姬", 105, 54],
    ["狄仁杰", 105, 50],["杨玉环", 103, 54],["张良", 101, 56],["女娲", 100, 48],
    ["姬小满", 100, 48],["孙策", 98, 43],["王昭君", 96, 48],["鲁班七号", 92, 49],
    ["裴擒虎", 82, 52],["嬴政", 82, 44],["明世隐", 77, 38],["镜", 74, 44],
    ["百里守约", 74, 37],["亚连", 70, 41],["墨子", 69, 28],["海月", 64, 36],
    ["安琪拉", 64, 27],["铠", 60, 30],["弈星", 57, 25],["桑启", 52, 22],
    ["影", 52, 22],["干将莫邪", 49, 24],["达摩", 47, 19],["廉颇", 46, 24],
    ["典韦", 45, 16],["西施", 41, 22],["后羿", 41, 21],["嫦娥", 41, 20],
    ["张飞", 36, 22],["蒙恬", 36, 19],["海诺", 35, 20],["哪吒", 33, 16],
    ["虞姬", 32, 12],["蔡文姬", 28, 15],["姜子牙", 26, 11],["空空儿", 23, 12],
    ["马可波罗", 23, 7],["白起", 17, 8],["伽罗", 16, 13],["澜", 16, 11],
    ["金蝉", 14, 5],["猪八戒", 13, 5],["孙膑", 12, 5],["暃", 12, 5],
    ["元歌", 11, 3],["苏烈", 10, 2],["庄周", 9, 4],["宫本武藏", 8, 2],
    ["老夫子", 7, 3],["李元芳", 6, 3],["露娜", 6, 3],["橘右京", 6, 2],
    ["盘古", 6, 1],["扁鹊", 5, 2],["兰陵王", 4, 2],["吕布", 4, 3],
    ["刘邦", 4, 2],["曜", 4, 1],["黄忠", 3, 1],["武则天", 3, 1],
    ["小乔", 3, 1],["莱西奥", 2, 1],["娜可露露", 2, 1],["牛魔", 2, 0],
    ["赵怀真", 2, 0],["花木兰", 1, 1],["上官婉儿", 1, 1],["东皇太一", 1, 1],
    ["钟馗", 1, 1],["貂蝉", 1, 0],["诸葛亮", 1, 0], ["鬼谷子", 1, 0],
    ["妲己", 1, 0],
]

# ==========================================
# 2. 2025 KPL 夏季赛完整数据 (102条)
# ==========================================
summer_data = [
    ["公孙离", 185, 85],["铠", 179, 97],["狂铁", 175, 91],["沈梦溪", 171, 85],
    ["夏洛特", 167, 88],["太乙真人", 164, 78],["少司缘", 154, 83],["空空儿", 151, 85],
    ["大司命", 148, 77],["苍", 138, 76],["阿古朵", 125, 61],["裴擒虎", 121, 56],
    ["孙尚香", 117, 52],["戈娅", 116, 59],["曹操", 116, 58],["不知火舞", 115, 60],
    ["杨戬", 115, 57],["苏烈", 114, 52],["鲁班大师", 111, 53],["关羽", 109, 55],
    ["司空震", 100, 47],["镜", 98, 56],["甄姬", 97, 48],["女娲", 95, 46],
    ["荆轲", 93, 44],["虞姬", 91, 43],["狄仁杰", 90, 50],["朵莉亚", 87, 37],
    ["鲁班七号", 85, 45],["张飞", 83, 33],["元流之子（射手）", 80, 45],["杨玉环", 80, 42],
    ["海月", 78, 44],["元流之子（坦克）", 77, 42],["马超", 74, 38],["梦奇", 74, 28],
    ["艾琳", 71, 38],["张良", 70, 41],["吕布", 70, 36],["暃", 66, 29],
    ["达摩", 65, 34],["夏侯惇", 65, 27],["小乔", 62, 33],["王昭君", 58, 31],
    ["海诺", 58, 29],["姬小满", 54, 21],["西施", 44, 20],["百里守约", 43, 20],
    ["蒙恬", 42, 19],["嫦娥", 40, 16],["后羿", 39, 17],["墨子", 37, 21],
    ["大乔", 36, 19],["安琪拉", 36, 18],["姜子牙", 35, 20],["干将莫邪", 34, 14],
    ["孙策", 32, 15],["橘右京", 31, 18],["弈星", 24, 8],["哪吒", 23, 10],
    ["廉颇", 23, 10],["娜可露露", 20, 15],["老夫子", 17, 9],["庄周", 16, 9],
    ["吕布", 15, 6],["孙权", 14, 8],["伽罗", 13, 7],["宫本武藏", 13, 7],
    ["猪八戒", 12, 8],["白起", 12, 5],["芈月", 11, 6],["蔡文姬", 10, 8],
    ["桑启", 10, 5],["金蝉", 10, 4],["牛魔", 9, 6],["虞姬", 9, 3],
    ["元歌", 9, 3],["马可波罗", 8, 3],["露娜", 8, 3],["曜", 7, 4],
    ["孙膑", 7, 4],["澜", 7, 3],["东皇太一", 6, 5],["武则天", 6, 3],
    ["明世隐", 6, 3],["兰陵王", 5, 4],["亚连", 5, 3],["鬼谷子", 3, 3],
    ["盾山", 3, 1],["赵怀真", 3, 1],["妲己", 2, 1],["高渐离", 2, 1],
    ["刘邦", 2, 0],["黄忠", 2, 0],["云缨", 1, 1],["钟馗", 1, 1],
    ["李元芳", 1, 0],["蒙犽", 1, 0],["盘古", 1, 0],["貂蝉", 1, 0],
    ["刘禅", 1, 0],["典韦", 1, 0]
]

# ==========================================
# 3. 2025 KPL 年度总决赛完整数据 (115条)
# ==========================================
finals_data = [
    ["沈梦溪", 78, 39], ["曹操", 77, 43], ["夏洛特", 74, 31], ["戈娅", 72, 38],
    ["公孙离", 72, 30], ["苍", 71, 33], ["苏烈", 70, 36], ["狂铁", 67, 36],
    ["女娲", 64, 43], ["大司命", 62, 33], ["杨戬", 62, 32], ["元流之子（坦克）", 41, 17],
    ["裴擒虎", 53, 32], ["铠", 52, 21], ["孙尚香", 51, 35], ["鲁班大师", 51, 23],
    ["少司缘", 50, 21], ["空空儿", 49, 33], ["盾山", 47, 26], ["蚩奼", 46, 24],
    ["太乙真人", 45, 22], ["不知火舞", 45, 21], ["小乔", 44, 18], ["镜", 42, 18],
    ["关羽", 41, 21], ["敖隐", 39, 23], ["朵莉亚", 39, 18], ["司空震", 38, 20],
    ["蒙恬", 37, 22], ["夏侯惇", 37, 21], ["鲁班七号", 37, 16], ["海月", 36, 19],
    ["阿古朵", 35, 13], ["狄仁杰", 33, 13], ["甄姬", 32, 18], ["艾琳", 32, 17],
    ["马超", 32, 12], ["张飞", 31, 19], ["影", 29, 11], ["杨玉环", 27, 14],
    ["安琪拉", 25, 9], ["海诺", 24, 11], ["西施", 24, 11], ["王昭君", 22, 13],
    ["嬴政", 22, 10], ["姬小满", 20, 12], ["橘右京", 19, 10], ["娜可露露", 19, 7],
    ["嫦娥", 18, 6], ["张良", 18, 5], ["廉颇", 15, 7], ["孙权", 14, 6],
    ["干将莫邪", 14, 3], ["百里守约", 13, 5], ["梦奇", 12, 4], ["猪八戒", 10, 6],
    ["老夫子", 9, 7], ["暃", 8, 6], ["大乔", 8, 4], ["达摩", 8, 3],
    ["墨子", 8, 2], ["虞姬", 7, 4], ["吕布", 6, 5], ["后羿", 6, 3],
    ["姜子牙", 6, 3], ["庄周", 5, 4], ["牛魔", 5, 2], ["武则天", 4, 4],
    ["宫本武藏", 4, 2], ["孙膑", 4, 1], ["元流之子（辅助）", 4, 0], ["桑启", 3, 2],
    ["蔡文姬", 3, 2], ["鬼谷子", 3, 2], ["伽罗", 3, 1], ["孙策", 3, 1],
    ["哪吒", 3, 1], ["弈星", 3, 1], ["曜", 2, 1], ["东皇太一", 2, 1],
    ["貂蝉", 1, 1], ["金蝉", 1, 0], ["刘邦", 1, 0], ["钟馗", 1, 0],
]

# ==========================================
# 4. 2025 挑战者杯完整数据 (90条)
# ==========================================
cup_data = [
    ["沈梦溪", 69, 33], ["曹操", 65, 28], ["公孙离", 59, 31], ["狂铁", 57, 28],
    ["戈娅", 56, 29], ["大司命", 53, 27], ["苏烈", 53, 26], ["蚩奼", 52, 20],
    ["夏洛特", 49, 90], ["女娲", 49, 27], ["盾山", 41, 22], ["空空儿", 41, 17],
    ["杨戬", 38, 22], ["元流之子（坦克）", 38, 22], ["苍", 38, 18], ["司空震", 36, 18],
    ["张飞", 36, 16], ["敖隐", 35, 18], ["小乔", 35, 15], ["不知火舞", 34, 22],
    ["少司缘", 33, 15], ["鲁班大师", 32, 19], ["艾琳", 31, 20], ["太乙真人", 31, 17],
    ["镜", 30, 16], ["朵莉亚", 30, 15], ["裴擒虎", 30, 14], ["马超", 28, 16],
    ["关羽", 27, 16], ["橘右京", 27, 14], ["影", 26, 14], ["狄仁杰", 26, 12],
    ["夏侯惇", 26, 11], ["嬴政", 24, 8], ["孙尚香", 23, 10], ["阿古朵", 21, 10],
    ["安琪拉", 20, 10], ["海月", 20, 9], ["杨玉环", 19, 10], ["铠", 18, 8],
    ["蒙恬", 17, 9], ["嫦娥", 15, 7], ["暃", 14, 8], ["西施", 14, 5],
    ["海诺", 13, 9], ["甄姬", 13, 8], ["虞姬", 13, 6], ["哪吒", 13, 4],
    ["廉颇", 10, 5], ["王昭君", 9, 6], ["姬小满", 9, 4], ["达摩", 9, 3],
    ["宫本武藏", 9, 2], ["张良", 8, 5], ["猪八戒", 8, 4], ["孙权", 8, 4],
    ["鲁班七号", 8, 3], ["武则天", 7, 5], ["吕布", 7, 2], ["娜可露露", 6, 5],
    ["牛魔", 6, 2], ["后羿", 5, 3], ["墨子", 5, 3], ["庄周", 5, 1],
    ["曜", 4, 4], ["百里守约", 4, 2], ["梦奇", 4, 2], ["东皇太一", 4, 2],
    ["老夫子", 4, 1], ["干将莫邪", 3, 1], ["伽罗", 3, 1], ["孙策", 3, 1],
    ["钟馗", 2, 2], ["桑启", 2, 1], ["刘邦", 2, 1], ["元流之子（辅助）", 2, 1],
    ["诸葛亮", 2, 0], ["姜子牙", 2, 0], ["金蝉", 1, 1], ["孙膑", 1, 1],
    ["兰陵王", 1, 1], ["露娜", 1, 1], ["大乔", 1, 1], ["弈星", 1, 0],
    ["貂蝉", 1, 0], ["韩信", 1, 0], ["云缨", 1, 0], ["亚连", 1, 0],
    ["高渐离", 1, 0], ["蔡文姬", 1, 0]
]

# ==========================================
# 5. 导出逻辑
# ==========================================
def export_csv(data_list, filename):
    df = pd.DataFrame(data_list, columns=['Hero_Name', 'Appearance_Count', 'Win_Count'])
    df = df[~df['Hero_Name'].str.contains("Placeholder")] # 去除填充项
    df.to_csv(f"{filename}.csv", index=False, encoding='utf-8-sig')
    return df

print("正在生成各赛季 CSV 文件...")
df_spring = export_csv(spring_data, "KPL_Spring_2025")
df_summer = export_csv(summer_data, "KPL_Summer_2025")
df_finals = export_csv(finals_data, "KPL_Finals_2025")
df_cup = export_csv(cup_data, "KPL_Cup_2025")

# 聚合汇总
print("正在生成年度汇总 CSV 文件...")
full_summary = pd.concat([df_spring, df_summer, df_finals, df_cup]).groupby('Hero_Name').sum().reset_index()
full_summary['Total_Win_Rate'] = full_summary['Win_Count'] / full_summary['Appearance_Count']
full_summary.to_csv("KPL_2025_Total_Summary.csv", index=False, encoding='utf-8-sig')

print("✅ 导出完成！共生成 5 个 CSV 文件。")